# GOV.UK Notify .NET client

This documentation is for developers interested in using this .NET client to integrate their government service with GOV.UK Notify.

## Installation

### Nuget Package Manager

The notifications-net-client is deployed to [Bintray](https://bintray.com/gov-uk-notify/nuget/Notify). 
<details>
<summary>
Click here to expand for more information.
</summary>

Navigate to your project directory and install Notify with the following command:
```
nuget install Notify -Source https://api.bintray.com/nuget/gov-uk-notify/notifications-net-client
```

Alternatively if you are using the Nuget Package Manager in Visual Studio, add the source below to install:
```
https://api.bintray.com/nuget/gov-uk-notify/nuget
```
</details>

### [Visual Studio](https://www.visualstudio.com/) (Windows)

To execute the NUnit tests you will need to install the [NUnit3 Test Adapter](https://marketplace.visualstudio.com/items?itemName=NUnitDevelopers.NUnit3TestAdapter) extension to Visual Studio.

<details>
<summary>Click here to expand for more information.</summary>

Setting Windows Environment variables

```
SETX NOTIFY_API_URL "https://example.notify-api.url"
SETX API_KEY "example_API_test_key"
SETX FUNCTIONAL_TEST_NUMBER "valid mobile number"
SETX FUNCTIONAL_TEST_EMAIL "valid email address"
SETX EMAIL_TEMPLATE_ID "valid email_template_id"
SETX SMS_TEMPLATE_ID "valid sms_template_id"
SETX LETTER_TEMPLATE_ID "valid letter_template_id"
```
</details>

### [Visual Studio](https://www.visualstudio.com/vs/visual-studio-mac/) (Mac OS)

In order to get the .Net client running in Visual Studio the target `.Net Framework` needs to be set to `4.5.2` and the application needs to be run from the terminal.

<details>
<summary>Click here to expand for more information.</summary>

```
open -n /Applications/"Visual Studio.app"
```

Setting Mac OS Environment variables (these must be sourced before opening the Visual Application using the command above)

```
export NOTIFY_API_URL=https://example.notify-api.url
export API_KEY=example_API_test_key
export FUNCTIONAL_TEST_NUMBER=valid mobile number
export FUNCTIONAL_TEST_EMAIL=valid email address
export EMAIL_TEMPLATE_ID=valid email_template_id
export SMS_TEMPLATE_ID=valid sms_template_id
export LETTER_TEMPLATE_ID=valid letter_template_id
```
</details>

## Getting started

```csharp
using Notify.Client;
using Notify.Models;
using Notify.Models.Responses;

NotificationClient client = new NotificationClient(apiKey);
```

Generate an API key by signing in to [GOV.UK Notify](https://www.notifications.service.gov.uk) and going to the **API integration** page.

## Send messages

### Text message

#### Method 

If the request is successful, `response` will be a `SmsNotificationResponse `.

<details>
<summary>
Click here to expand for more information.
</summary>

```csharp
SmsNotificationResponse response = client.SendSms(mobileNumber, templateId, personalisation, reference);
```
</details>

#### Response

<details>
<summary>
Click here to expand for more information.
</summary>

```csharp
public String fromNumber;
public String body;
public String id;
public String reference;
public String uri;
public Template template;

public class Template {
    public String id;
    public String uri;
    public Int32 version;
}

```

Otherwise the client will raise a `Notify.Exceptions.NotifyClientException`:

|`error.status_code`|`error.message`|
|:---|:---|
|`429`|`[{`<br>`"error": "RateLimitError",`<br>`"message": "Exceeded rate limit for key type TEAM of 10 requests per 10 seconds"`<br>`}]`|
|`429`|`[{`<br>`"error": "TooManyRequestsError",`<br>`"message": "Exceeded send limits (50) for today"`<br>`}]`|
|`400`|`[{`<br>`"error": "BadRequestError",`<br>`"message": "Can"t send to this recipient using a team-only API key"`<br>`]}`|
|`400`|`[{`<br>`"error": "BadRequestError",`<br>`"message": "Can"t send to this recipient when service is in trial mode - see https://www.notifications.service.gov.uk/trial-mode"`<br>`}]`|

</details>


#### Arguments

XYZ
<details>
<summary>
Click here to expand for more information.
</summary>

XYZ
</details>


### Email

#### Method

XYZ
<details>
<summary>
Click here to expand for more information.
</summary>

XYZ
</details>


#### Response

XYZ
<details>
<summary>
Click here to expand for more information.
</summary>

XYZ
</details>


#### Arguments

XYZ
<details>
<summary>
Click here to expand for more information.
</summary>

XYZ
</details>


### Letter

#### Method

XYZ
<details>
<summary>
Click here to expand for more information.
</summary>

XYZ
</details>


#### Response

XYZ
<details>
<summary>
Click here to expand for more information.
</summary>

XYZ
</details>


#### Arguments

XYZ
<details>
<summary>
Click here to expand for more information.
</summary>

XYZ
</details>


## Get the status of one message

#### Method

XYZ
<details>
<summary>
Click here to expand for more information.
</summary>

XYZ
</details>


#### Response

XYZ
<details>
<summary>
Click here to expand for more information.
</summary>

XYZ
</details>

#### Arguments

XYZ
<details>
<summary>
Click here to expand for more information.
</summary>

XYZ
</details>

## Get the status of all messages (with pagination)

#### Method

XYZ
<details>
<summary>
Click here to expand for more information.
</summary>

XYZ
</details>


#### Response

XYZ
<details>
<summary>
Click here to expand for more information.
</summary>

XYZ
</details>



#### Arguments

XYZ
<details>
<summary>
Click here to expand for more information.
</summary>

XYZ
</details>


## Get the status of all messages (without pagination)

#### Method

XYZ
<details>
<summary>
Click here to expand for more information.
</summary>

XYZ
</details>

#### Response

XYZ
<details>
<summary>
Click here to expand for more information.
</summary>

XYZ
</details>


#### Arguments

XYZ
<details>
<summary>
Click here to expand for more information.
</summary>

XYZ
</details>


## Get a template by ID

#### Method 

XYZ
<details>
<summary>
Click here to expand for more information.
</summary>

XYZ
</details>


#### Response

XYZ
<details>
<summary>
Click here to expand for more information.
</summary>

XYZ
</details>


#### Arguments

XYZ
<details>
<summary>
Click here to expand for more information.
</summary>

XYZ
</details>


## Get all templates

#### Method

XYZ
<details>
<summary>
Click here to expand for more information.
</summary>

XYZ
</details>


#### Response

XYZ
<details>
<summary>
Click here to expand for more information.
</summary>

XYZ
</details>


#### Arguments

XYZ
<details>
<summary>
Click here to expand for more information.
</summary>

XYZ
</details>


## Generate a preview template

#### Method

XYZ
<details>
<summary>
Click here to expand for more information.
</summary>

XYZ
</details>


#### Response

XYZ
<details>
<summary>
Click here to expand for more information.
</summary>

XYZ
</details>


#### Arguments

XYZ
<details>
<summary>
Click here to expand for more information.
</summary>

XYZ
</details>



